# Generated By: Cursor (Claude Sonnet 4.5)
"""Tests for progress summary functionality."""

from datetime import datetime, timezone, timedelta

import gh_pr_metrics


class TestProgressSummary:
    """Test show_update_all_progress_summary function."""

    def test_progress_summary_with_stopped_repo(self):
        """Test progress summary when stopped at a specific repo."""
        now = datetime.now(timezone.utc)
        old = now - timedelta(hours=24)
        recent = now - timedelta(hours=6)

        tracked_repos = [
            {"timestamp": recent, "owner": "o1", "repo": "r1"},  # Recent
            {"timestamp": recent, "owner": "o2", "repo": "r2"},  # Recent
            {"timestamp": old, "owner": "o3", "repo": "r3"},  # Old
            {"timestamp": old, "owner": "o4", "repo": "r4"},  # Old
        ]

        # This should not raise an error and should log properly
        gh_pr_metrics.show_update_all_progress_summary(
            tracked_repos, completed_repos=2, stopped_at="o3/r3"
        )

        # No assertion needed - just verify it doesn't crash

    def test_progress_summary_before_start(self):
        """Test progress summary before any processing starts."""
        now = datetime.now(timezone.utc)
        old = now - timedelta(hours=24)
        recent = now - timedelta(hours=6)

        tracked_repos = [
            {"timestamp": recent, "owner": "o1", "repo": "r1"},
            {"timestamp": old, "owner": "o2", "repo": "r2"},
        ]

        # This should not raise an error
        gh_pr_metrics.show_update_all_progress_summary(
            tracked_repos, completed_repos=0, stopped_at=None
        )

        # No assertion needed - just verify it doesn't crash
