# GitHub Pull Request Metrics Tool

Generated By: Cursor (Claude Sonnet 4.5)

A command-line tool to generate CSV reports containing key metrics for all pull requests in a GitHub repository within a specified time range.

## Features

- **Comprehensive Metrics**: Collects PR creation time, review readiness, comments, reviews, and status
- **Flexible Time Ranges**: Analyze PRs from any time period (default: last year)
- **CSV Output**: Machine-readable format for further analysis
- **Smart Defaults**: Works with minimal configuration by auto-detecting repository information
- **Debug Logging**: Detailed logging for troubleshooting

## Installation

```bash
# Install the tool with runtime dependencies
make install
```

## Usage

After installation, the tool is available in the virtual environment:

```bash
# Show help
.venv/bin/gh-pr-metrics --help

# Run the tool (analyzes current repository, last 365 days)
.venv/bin/gh-pr-metrics

# With arguments
.venv/bin/gh-pr-metrics --owner microsoft --repo vscode
.venv/bin/gh-pr-metrics --start 2024-01-01 --end 2024-12-31
.venv/bin/gh-pr-metrics --output metrics.csv
.venv/bin/gh-pr-metrics --debug
```

## Environment Variables

- `GITHUB_TOKEN`: GitHub personal access token for authentication (optional for public repos)

## Development

```bash
# Install development dependencies (includes runtime deps + testing/linting tools)
make requirements-dev

# Run individual targets
make format    # Format code with black
make lint      # Check code with flake8
make test      # Run tests with pytest
make coverage  # Generate coverage report and verify threshold
make clean     # Remove temporary files and virtual environment
```

### Project Structure

```
gh-pr-metrics/
├── src/
│   └── gh_pr_metrics.py     # Main application
├── tests/
│   ├── unit/                # Unit tests
│   └── integration/         # Integration tests (placeholder)
├── docs/                    # Documentation
│   ├── requirements.md      # Detailed requirements
│   └── unit-test-plan.md    # Test plan
├── make/                    # Modular Makefile components
│   ├── common.mk           # Common variables
│   ├── env.mk              # Environment setup
│   ├── lint.mk             # Linting and formatting
│   └── test.mk             # Testing and coverage
├── .github/workflows/       # GitHub Actions CI/CD
├── Makefile                 # Main build automation
└── pyproject.toml           # Project configuration (PEP 517/518)
```

## CSV Output Format

The tool generates a CSV with the following columns:

- `pr_number` - Pull request number
- `created_at` - ISO 8601 timestamp when PR was created
- `ready_for_review_at` - ISO 8601 timestamp when PR was last marked ready
- `comments_total` - Total number of all comments (includes bot comments)
- `comments_bot` - Number of comments from bots
- `change_requests_total` - Total number of change requests
- `change_requests_unique` - Count of unique reviewers who requested changes
- `approvals` - Number of approvals (latest state per reviewer)
- `status` - Current PR status (draft, open, closed, merged)
- `errors` - Optional column with error messages if partial data was retrieved

## Requirements

- Python 3.10+
- GitHub.com access (GitHub Enterprise not supported)

## License

MIT License

## Contributing

When contributing:
1. Follow existing code style
2. Add tests for new features
3. Ensure `make` passes without errors
4. Add `Assisted-by: Cursor (Claude Sonnet 4.5)` to commit messages

## Status

**Current Version**: 0.1.0

**Development Status**: Core functionality complete, 43 unit tests passing, 71% code coverage

